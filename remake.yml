# This file is automatically generated from remake.yml.whisker:
# edit the file there (or the files that it includes).

packages:
  - BayesCorrOcc
  - rBBS
  - RPresence
  - rmarkdown
  - knitr
  - markdown
  - BBS.tenstop
  - foreach

targets:
  all:
    depends:
      - inst/reports/WOTH.html
      - inst/reports/FICR.html

## Data used for all species
  bbs:
    command: get_BBS10()

## Format BBS & climate data
  inst/output/WOTH:
    command: CreateSpp(I(alpha = "WOTH"))
    depends:
      - inst/spp_list.csv


  WOTH_AOU:
    command: GetAOU(I(alpha = "WOTH"))
    depends:
      - inst/spp_list.csv

  WOTH_BCR:
    command: GetBCR(I(alpha = "WOTH"))
    depends:
      - inst/spp_list.csv

  inst/output/WOTH/bbs_data.rds:
    command: GetCorrData(bbs_raw = bbs, AOU = WOTH_AOU, I(start.year = 1972), I(end.year = 2014), path = 'inst/output/WOTH', bcr = WOTH_BCR)


  inst/output/WOTH/biovars.rds:
    command: GetBioVars(I(alpha = "WOTH"))
    depends:
      - inst/output/WOTH/bbs_data.rds
  inst/output/FICR:
    command: CreateSpp(I(alpha = "FICR"))
    depends:
      - inst/spp_list.csv


  FICR_AOU:
    command: GetAOU(I(alpha = "FICR"))
    depends:
      - inst/spp_list.csv

  FICR_BCR:
    command: GetBCR(I(alpha = "FICR"))
    depends:
      - inst/spp_list.csv

  inst/output/FICR/bbs_data.rds:
    command: GetCorrData(bbs_raw = bbs, AOU = FICR_AOU, I(start.year = 1972), I(end.year = 2014), path = 'inst/output/FICR', bcr = FICR_BCR)


  inst/output/FICR/biovars.rds:
    command: GetBioVars(I(alpha = "FICR"))
    depends:
      - inst/output/FICR/bbs_data.rds

## Get initial values from Presence
  inits:
    command: GetInits()
    depends:
      - inst/spp_list.csv
      - inst/output/WOTH/biovars.rds
      - inst/output/FICR/biovars.rds

## Run models
  run_mods:
    command: RunMod(spp = inits)

  run_ppc:
    command: ppc(spp = run_mods)


## Get indices
  occ_run:
    command: GetOccProb(spp = run_ppc)


  occ_summary:
    command: OccSummary(spp = occ_run)


  indices:
    command: GetIndices(spp = occ_summary)

  WOTH:
    command: GetSummary(I(alpha = "WOTH"))
    depends:
      - indices


## Generate reports
  inst/output/WOTH/report.md:
    knitr:
      input: inst/report.Rmd
      auto_figure_prefix: true
    depends:
      - spp_summ: WOTH
      - R/figures.R
      - indices
    cleanup_level: purge

  inst/reports/WOTH.html:
    command: md2html(filename = "inst/output/WOTH/report.md", dest = target_name)
    cleanup_level: purge

  FICR:
    command: GetSummary(I(alpha = "FICR"))
    depends:
      - indices


## Generate reports
  inst/output/FICR/report.md:
    knitr:
      input: inst/report.Rmd
      auto_figure_prefix: true
    depends:
      - spp_summ: FICR
      - R/figures.R
      - indices
    cleanup_level: purge

  inst/reports/FICR.html:
    command: md2html(filename = "inst/output/FICR/report.md", dest = target_name)
    cleanup_level: purge


