# This file is automatically generated from remake.yml.whisker:
# edit the file there (or the files that it includes).

packages:
  - BayesCorrOcc
  - rBBS
  - RPresence
  - rmarkdown
  - knitr
  - markdown
  - BBS.tenstop

targets:
  all:
    depends:
      - inst/reports/GTGR.html

## Data used for all species
  NA_biovars:
    command: data(target_name)

  bbs:
    command: get_BBS10()

## Format BBS & climate data
  inst/output/GTGR:
    command: CreateSpp(I(alpha = "GTGR"))
    depends:
      - inst/spp_list.csv


  GTGR_AOU:
    command: GetAOU(I(alpha = "GTGR"))
    depends:
      - inst/spp_list.csv

  GTGR_BCR:
    command: GetBCR(I(alpha = "GTGR"))
    depends:
      - inst/spp_list.csv

  inst/output/GTGR/bbs_data.rds:
    command: GetCorrData(bbs_raw = bbs, AOU = GTGR_AOU, I(start.year = 1972), I(end.year = 2014), path = 'inst/output/GTGR', bcr = GTGR_BCR)


  inst/output/GTGR/biovars.rds:
    command: GetBioVars(I(alpha = "GTGR"))
    depends:
      - inst/output/GTGR/bbs_data.rds



## Get initial values from Presence
  inst/output/GTGR/inits.rds:
    command: GetInits(I(alpha = "GTGR"))
    depends:
      - inst/output/GTGR/biovars.rds


## Run models
  inst/output/GTGR/jags_fit.rds:
    command: RunMod(I(alpha = "GTGR", nI = 100, nA = 25, nC = 1, nT = 5))
    depends:
      - inst/output/GTGR/inits.rds



## Generate indices

  inst/output/GTGR/occ.rds:
    command: GetOccProb(I(alpha = "GTGR"))
    depends:
      - inst/output/GTGR/jags_fit.rds


  inst/output/GTGR/psi.rds:
    command: OccSummary(I(alpha = "GTGR"))
    depends:
      - inst/output/GTGR/occ.rds


  inst/output/GTGR/indices.csv:
    command: GetIndices(I(alpha = "GTGR"))
    depends:
      - inst/output/GTGR/psi.rds


  GTGR:
    command: GetSummary(I(alpha = "GTGR"))
    depends:
      - inst/output/GTGR/indices.csv


## Generate reports
  inst/output/GTGR/report.md:
    knitr:
      input: inst/report.Rmd
      auto_figure_prefix: true
    depends:
      - spp_summ: GTGR
      - R/figures.R
      - inst/output/GTGR/indices.csv
    cleanup_level: purge

  inst/reports/GTGR.html:
    command: md2html(filename = "inst/output/GTGR/report.md", dest = target_name)
    cleanup_level: purge


